== Solr Operations

=== Partial Updates

=== Partial Updates

* Update the products of an existing Store

=== Partial Updates

[source, language="java"]
----
@Autowired
private SolrTemplate solrTemplate;

@Override
public void updateProducts(String id, Collection<String> products) {
    final PartialUpdate partialUpdate = new PartialUpdate("id", id);
    partialUpdate.add("products", products);
    solrTemplate.saveBean(partialUpdate);
    solrTemplate.commit();
}
----

=== Filter Query

=== Filter Query

* Find Stores by Name, using Filter Query

=== Filter Query

==== @Query Annotation

[source, language="java"]
----

@Query(value = "*:*", filters = {"name:=?0"})
Collection<Store> findByNameFilterQuery(final String name);

----

=== Filter Query

==== Solr Template

[source, language="java"]
----
@Override
public Collection<Store> FindStoreByNameFilterQuery(final String name){
   final SimpleQuery query = new SimpleQuery(new Criteria());
   final FilterQuery filterQuery =
            new SimpleFilterQuery(new Criteria("name").is(name));
   query.addFilterQuery(filterQuery);
   ScoredPage<Store> result =
            solrTemplate.queryForPage(query, Store.class);
   return result.getContent();
}
----

=== Facetting

=== Facetting

* Find stores by product, using Filter and "facet" by name
* Find stores by zipCode and "facet" by products

=== Facetting

[source, language="java"]
----
@Query(value = "*:*", filters = "products:?0")
@Facet(fields = {"name"})
FacetPage<Store> findFacetOnName(@Param("products")
        final List<String> products, final Pageable page);
----

[source, language="java"]
----
@Query(value = "zipCode:?0")
@Facet(fields = {"products"})
FacetPage<Store> findByZipCodeFacetOnProducts(
    @Param("zipCode") final String zipCode,
    final Pageable page);
----

=== Facetting

[source, language="java"]
----
@Override
public FacetPage<Store> findFacetOnNameSolrTemplate(
        final List<String> products) {
  final String parameter = convertListToParameterString(products);
  final FacetQuery facetQuery = new SimpleFacetQuery(
                new SimpleStringCriteria("*:*"))
      .setFacetOptions(new FacetOptions("name"));
  final FilterQuery filterQuery = new SimpleFilterQuery(
                new SimpleStringCriteria("products:" + parameter));
  facetQuery.setPageRequest(new PageRequest(0, 20));
  facetQuery.addFilterQuery(filterQuery);
  return solrTemplate.queryForFacetPage(facetQuery, Store.class);
}
----

=== Grouping

=== Grouping

* Find Stores by products and group by zipCode

=== Grouping
[source, language="java"]
----
@Override
public GroupPage<Store> groupByZipCode(final List<String> products) {
  final Field zipCodeField = new SimpleField("zipCode");
  final Query query = new SimpleQuery(new Criteria("products")
            .contains(products));
  final SimpleQuery groupQuery =
             new SimpleQuery(new SimpleStringCriteria("*:*"));
  final GroupOptions groupOptions = new GroupOptions()
      .addGroupByField(zipCodeField)
      .addGroupByQuery(query);
   groupQuery.setGroupOptions(groupOptions);
   return solrTemplate.queryForGroupPage(groupQuery, Store.class)
}
----

=== More Operations

* Field Stats
* Pivot Faceting
* Terms
* Time allowed for a search
* Boost document Score

=== More Operations

* Select Request Handler
* Using Join
* Highlighting
* Using Functions
* Realtime Get




